// Arduino soil moisture sensor code

// declare variables for pins
const int sensorpin = A0;
const int sensorpower = 8;
const int pumppin = 11;

// variable for sensor reading
int sensor;

// delay time between sensor readings (milliseconds)
const int delayTime = 1000;  // Delay zwiększony na jedną sekundę

// "wet" and "dry" thresholds - these require calibration
int wet = 800;
int dry = 500;

void setup() { // code that only runs once
  // set pins as outputs
  pinMode(sensorpower, OUTPUT);
  pinMode(pumppin, OUTPUT);
  
  // initialize serial communication
  Serial.begin(9600);
}

void loop() { // code that loops forever
  // power on sensor and wait briefly
  digitalWrite(sensorpower, HIGH);
  delay(10);
  
  // take reading from sensor
  sensor = analogRead(sensorpin);
  
  // turn sensor off to help prevent corrosion
  digitalWrite(sensorpower, LOW);
  
  // print sensor reading
  Serial.println(sensor);
  
  // If sensor reading is greater than "wet" threshold,
  // turn on the pump. If it is less than the "dry"
  // threshold, turn on the pump. 
  // If it is in between the two values, do nothing.
  if (sensor > wet || sensor < dry) {
    digitalWrite(pumppin, HIGH);
  } else {
    digitalWrite(pumppin, LOW);
  }
  
  // wait before taking next reading
  delay(delayTime);
}
